{% extends 'base.html' %}

{% block title %}Subject List{% endblock %}

{% block content %}
<div class="container-main">
  <h2 class="display-5 text-center mb-4" style="color: var(--primary-color);">Academic Records</h2>

  <!-- Action Bar -->
  <div class="d-flex flex-column flex-md-row justify-content-between gap-3 mb-4">
    <form method="get" class="d-flex gap-2 flex-grow-1">
      <input type="text" name="q" value="{{ query }}" 
             placeholder="Search subjects..." 
             class="form-control search-input shadow-sm"
             style="border-radius: 25px; border: 1px solid var(--primary-color);">
      <button type="submit" class="btn btn-primary px-4" 
              style="border-radius: 25px; background: var(--secondary-color); border: none;">
        <i class="bi bi-search"></i> Search
      </button>
    </form>
    
    <div class="d-flex gap-2 justify-content-end">
      <a href="{% url 'export_subjects' %}" 
         class="btn btn-outline-primary d-flex align-items-center gap-2"
         style="border-radius: 25px;">
        <i class="bi bi-download"></i> Export
      </a>
      <a href="{% url 'import_subjects' %}" 
         class="btn btn-outline-success d-flex align-items-center gap-2"
         style="border-radius: 25px;">
        <i class="bi bi-upload"></i> Import
      </a>
      <a href="{% url 'create_subject' %}" 
         class="btn btn-primary d-flex align-items-center gap-2"
         style="border-radius: 25px; background: var(--secondary-color); border: none;">
        <i class="bi bi-plus-lg"></i> New Subject
      </a>
    </div>
  </div>

  <!-- Data Table -->
  <div class="table-responsive rounded-3 shadow-sm">
    <table class="table table-hover align-middle mb-0">
      <thead class="sticky-top" style="background: var(--primary-color); color: white;">
        <tr>
          <th>Student</th>
          <th>Year</th>
          <th>Subject 1</th>
          <th>Subject 2</th>
          <th>Subject 3</th>
          <th>Subject 4</th>
          <th>Subject 5</th>
          <th>Subject 6</th>
          <th>Total</th>
          <th class="text-end">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for subject in page_obj %}
          <tr>
            <td>
              <div class="d-flex align-items-center gap-2">
                <div class="avatar-sm bg-info text-white rounded-circle d-flex align-items-center justify-content-center">
                  {{ subject.student.name|first }}
                </div>
                {{ subject.student.name }}
              </div>
            </td>
            <td>{{ subject.year }}</td>
            <td class="{% if subject.subject1_marks < 40 %}text-danger{% endif %}">
              {{ subject.subject1_marks }}
            </td>
            <td class="{% if subject.subject2_marks < 40 %}text-danger{% endif %}">
              {{ subject.subject2_marks }}
            </td>
            <td class="{% if subject.subject3_marks < 40 %}text-danger{% endif %}">
              {{ subject.subject3_marks }}
            </td>
            <td class="{% if subject.subject4_marks < 40 %}text-danger{% endif %}">
              {{ subject.subject4_marks }}
            </td>
            <td class="{% if subject.subject5_marks < 40 %}text-danger{% endif %}">
              {{ subject.subject5_marks }}
            </td>
            <td class="{% if subject.subject6_marks < 40 %}text-danger{% endif %}">
              {{ subject.subject6_marks }}
            </td>
            <td>
              <span class="badge bg-success-subtle text-success">
                {{ subject.total_marks }}
              </span>
            </td>
            <td class="text-end">
              <div class="d-flex gap-2 justify-content-end">
                
                <a href="{% url 'edit_subject' subject.id %}" 
                   class="btn btn-sm btn-outline-warning px-3"
                   style="border-radius: 20px;">
                   Edit
                </a>
                <a href="{% url 'delete_subject' subject.id %}" 
                   class="btn btn-sm btn-danger px-3"
                   style="border-radius: 20px;">
                   Delete
                </a>
              </div>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <nav class="mt-4">
    <ul class="pagination justify-content-center">
      {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page=1&q={{ query }}" 
             style="border-radius: 20px; margin-right: 8px;">
            <i class="bi bi-chevron-double-left"></i>
          </a>
        </li>
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.previous_page_number }}&q={{ query }}" 
             style="border-radius: 20px; margin-right: 8px;">
            Previous
          </a>
        </li>
      {% endif %}

      {% for num in page_obj.paginator.page_range %}
        {% if page_obj.number == num %}
          <li class="page-item active">
            <span class="page-link" 
                  style="border-radius: 20px; margin-right: 8px; background: var(--secondary-color);">
              {{ num }}
            </span>
          </li>
        {% else %}
          <li class="page-item">
            <a class="page-link" href="?page={{ num }}&q={{ query }}" 
               style="border-radius: 20px; margin-right: 8px;">
              {{ num }}
            </a>
          </li>
        {% endif %}
      {% endfor %}

      {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.next_page_number }}&q={{ query }}" 
             style="border-radius: 20px; margin-right: 8px;">
            Next
          </a>
        </li>
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}&q={{ query }}" 
             style="border-radius: 20px;">
            <i class="bi bi-chevron-double-right"></i>
          </a>
        </li>
      {% endif %}
    </ul>
  </nav>
</div>

<style>
  .avatar-sm {
    width: 32px;
    height: 32px;
    font-size: 14px;
  }
  .badge.bg-success-subtle {
    background-color: rgba(40, 167, 69, 0.1) !important;
    color: #28a745 !important;
    padding: 0.35em 0.65em;
  }
  .table-hover tbody tr:hover {
    background-color: rgba(52, 152, 219, 0.05);
    transform: translateX(4px);
    transition: all 0.2s ease;
  }
  .page-link {
    color: var(--primary-color);
    border: 1px solid var(--primary-color);
    min-width: 40px;
    text-align: center;
  }
  .page-link:hover {
    background: var(--secondary-color) !important;
    color: white !important;
    border-color: var(--secondary-color);
  }
  .text-danger {
    font-weight: 500;
  }
</style>
{% endblock %}
4 minutes ago
